# genv-ex

A lightweight Node.js utility to generate a `.env.example` file from a `.env` file, replacing sensitive values with placeholders. Ideal for sharing environment variable templates in Node.js and full-stack projects.

## Features

- Generates `.env.example` from `.env` with customizable placeholders.
- Preserves comments and empty lines for better readability.
- Supports preserving specific values or ignoring keys.
- Configurable via CLI, programmatic API, or `.genv-exrc` file.
- Handles large files efficiently with streaming.
- Interactive CLI prompts for missing `.env` files.
- CommonJS and ESM compatible.

## Installation

Install globally for CLI use:

```bash
npm install -g genv-ex
```

Or locally in a project:

```bash
npm install genv-ex
```

For development with `nodemon`:

```bash
npm install --save-dev nodemon

```

## File Structure

Ensure your project has the following structure:

```
your-project/
├── .env              # Source environment file
├── .genv-exrc        # Optional config file
├── node_modules/
├── package.json
└── genv-ex/          # If developing locally
    ├── index.js      # Main module
    ├── bin/
    │   └── cli.js    # CLI script

```

## Usage

`genv-ex` can be used via the command-line interface (CLI) or programmatically in your Node.js code.

### CLI Usage

Run `genv-ex` to generate `.env.example` from `.env` with default settings:

```bash
npx genv-ex
```

This reads `.env`, replaces values with `<YOUR_VALUE_HERE>`, and creates `.env.example`, preserving comments.

### Common Commands

- Specify input/output files:
  ```bash
  npx genv-ex -i .env.prod -o .env.prod.example
  ```
- Preserve specific keys:
  ```bash
  npx genv-ex --preserve API_KEY PUBLIC_URL
  ```
- Ignore keys:
  ```bash
  npx genv-ex --ignore SECRET_TOKEN
  ```
- Exclude comments:
  ```bash
  npx genv-ex --no-comments
  ```
- Preview without writing:
  ```bash
  npx genv-ex --dry-run
  ```
- Create a sample `.env`:
  ```bash
  npx genv-ex --init
  ```

### Interactive Mode

If no `.env` file exists, the CLI prompts to create a sample:

```bash
$ npx genv-ex
No '.env' file found.
Create a sample .env file? (y/n): y
Created '.env'. Edit it and run again.
```

### Help

See all options:

```bash
npx genv-ex --help
```

### Package Scripts

Add to `package.json` for convenience:

```json
{
  "scripts": {
    "gen-env": "genv-ex",
    "start": "nodemon bin/cli.js"
  }
}
```

Run:

```bash
npm run gen-env
```

### Programmatic Usage

Use `genv-ex` in your Node.js code for integration into scripts or applications.

### CommonJS

```jsx
// index.js
const generateEnvExample = require("genv-ex");

generateEnvExample()
  .then((result) => console.log("Generated:", result))
  .catch((error) => console.error("Error:", error.message));
```

Run:

```bash
node index.js
```

### ESM

For ESM projects (`"type": "module"` in `package.json`):

```jsx
// index.js
import generateEnvExample from "genv-ex";

async function run() {
  const result = await generateEnvExample({
    preserveValues: ["API_KEY"],
    ignoreKeys: ["SECRET"],
  });
  console.log("Generated:", result);
}

run();
```

`package.json`:

```json
{
  "type": "module",
  "dependencies": {
    "genv-ex": "^1.0.0"
  }
}
```

Run:

```bash
node index.js
```

### Example Output

For a `.env` file:

```
# Database config
API_KEY=xyz123
DATABASE_URL=mongodb://localhost:27017
SECRET=hidden
```

Running `npx genv-ex --preserve API_KEY --ignore SECRET`:

```
# Generated by genv-ex
# Auto-generated on 2025-04-12T12:34:56.789Z
# Database config
API_KEY=xyz123
DATABASE_URL=<YOUR_VALUE_HERE>
```

Console output:

```
Successfully created '.env.example' with 2 keys
Skipped keys: SECRET
```

### Configuration File

Use a `.genv-exrc` file to set defaults (supports JSON5 for comments, trailing commas):

```json
{
  // Default placeholder
  "placeholder": "YOUR_VALUE",
  // Preserve these keys
  "preserveValues": ["API_KEY", "PUBLIC_URL"],
  // Include comments
  "includeComments": true
}
```

CLI or programmatic options override `.genv-exrc`.

### Options

| Option            | Description                           | Default                     |
| ----------------- | ------------------------------------- | --------------------------- |
| `envFilePath`     | Source .env file path                 | `.env`                      |
| `outputFilePath`  | Output .env.example file path         | `.env.example`              |
| `placeholder`     | Placeholder for values                | `<YOUR_VALUE_HERE>`         |
| `preserveValues`  | Array of keys to keep original values | `[]`                        |
| `ignoreKeys`      | Array of keys to exclude              | `[]`                        |
| `includeComments` | Preserve comments and empty lines     | `true`                      |
| `header`          | Custom header text                    | `# Generated by genv-ex...` |
| `force`           | Overwrite existing output file        | `true`                      |
| `silent`          | Suppress console output               | `false`                     |
| `dryRun`          | Preview output without writing        | `false`                     |
| `configFile`      | Path to config file                   | `.genv-exrc`                |

CLI flags (e.g., `--no-comments`, `--no-force`) override defaults.

### Running with Nodemon

For development, use `nodemon` to watch for changes:

```bash
npm run start
```

**Tip**: Add `.env.example` to `.nodemonignore` to prevent infinite loops:

```
.env.example
```

If you encounter crashes, ensure `bin/cli.js` exists and `package.json` scripts are correct.

### Troubleshooting

- **No `.env` file**:
  - Run `npx genv-ex --init` to create a sample.
  - Or create `.env` manually with `API_KEY=your_key`.
- **File not found**:
  - Verify `bin/cli.js` exists in `genv-ex/bin/`.
  - Check `package.json`’s `bin` and `scripts`.
- **Nodemon crashes**:
  - Run `node bin/cli.js` to isolate errors.
  - Ensure script points to `bin/cli.js`, not `src/cli.js`.
- **Permissions**:
  - Run `chmod +x bin/cli.js`.
  - Check write access: `chmod u+w .`.
- **Dependencies**:
  ```bash
  npm install dotenv json5 commander
  npm install --save-dev nodemon
  ```

### Contributing

Contributions are welcome! To contribute:

1. Fork the repository.
2. Create a branch: `git checkout -b feature/your-feature`.
3. Commit changes: `git commit -m "Add your feature"`.
4. Push: `git push origin feature/your-feature`.
5. Open a pull request.

Please include tests and update this `README.md`.

### License

MIT License. See [LICENSE](https://www.notion.so/LICENSE) for details.

```

---

### Explanation of `README.md`

1. **Overview**:
   - Clearly describes `genv-ex` as a utility for generating `.env.example`.
   - Lists key features to highlight value (e.g., comments, streaming).

2. **Installation**:
   - Covers global, local, and `nodemon` setups.
   - Mentions dependencies (`dotenv`, `json5`, `commander`).

3. **File Structure**:
   - Clarifies expected layout (`bin/cli.js`, not `src/cli.js`) to avoid path errors.
   - Helps users verify setup.

4. **Usage**:
   - **CLI**: Detailed commands with examples for common tasks (e.g., `--preserve`, `--init`).
   - **Programmatic**: Shows CommonJS and ESM usage, addressing your `import` interest.
   - **Interactive Mode**: Highlights prompts for missing `.env`.
   - **Output Example**: Shows input `.env` and resulting `.env.example`.

5. **Configuration**:
   - Explains `.genv-exrc` with a sample.
   - Lists all options in a table for clarity.

6. **Nodemon**:
   - Guides running with `nodemon` and avoiding loops via `.nodemonignore`.
   - Addresses your crash issue by ensuring `bin/cli.js`.

7. **Troubleshooting**:
   - Covers common issues (e.g., missing files, permissions).
   - References the `src/cli.js` error and correct path.

8. **Contributing and License**:
   - Standard sections to encourage contributions and clarify licensing.

---

### File Structure Notes

The `README.md` assumes:

```

genv-ex/
├── index.js
├── bin/
│ └── cli.js
├── package.json
├── [README.md](http://readme.md/)
└── node_modules/

````

If you’re using `src/cli.js`, update the `README.md`:

```markdown
your-project/
├── .env
├── .genv-exrc
├── node_modules/
├── package.json
└── genv-ex/
    ├── index.js
    ├── src/
    │   └── cli.js

```

And `package.json`:

```json
{
  "bin": {
    "genv-ex": "./src/cli.js"
  },
  "scripts": {
    "start": "nodemon src/cli.js"
  }
}
```

Since your error pointed to `src/cli.js` but the code uses `bin/cli.js`, I’ve assumed `bin/` is correct unless you confirm otherwise.

---

### Testing the Setup

1. **Save `README.md`**:

   ```bash
   cd /Users/jaydee/Desktop/env-example-generator/genv-ex
   echo "..." > README.md

   ```

   (Copy the above `README.md` content.)

2. **Verify Files**:

   ```bash
   ls -R

   ```

   Should show:

   ```
   bin/  index.js  package.json  README.md
   ./bin:
   cli.js

   ```

3. **Run CLI**:

   ```bash
   npm install
   npx genv-ex

   ```

4. **Run with Nodemon**:

   ```bash
   npm start

   ```

5. **Test Programmatic**:

   ```jsx
   // test.js
   const generateEnvExample = require("./index");
   generateEnvExample().then(console.log).catch(console.error);
   ```

   ```bash
   node test.js

   ```

---

### Troubleshooting

If issues persist:

- **Wrong Path**:

  - Confirm `bin/cli.js` exists:

    ```bash
    ls /Users/jaydee/Desktop/env-example-generator/genv-ex/bin/cli.js

    ```

  - If using `src/`, move `cli.js` or update `package.json`.

- **Nodemon**:

  - Check `package.json` scripts.
  - Try:

    ```bash
    nodemon bin/cli.js

    ```

- **Share Details**:
  - Full `package.json`.
  - Output of `ls -R /Users/jaydee/Desktop/env-example-generator/genv-ex`.
  - Any new errors.
````
